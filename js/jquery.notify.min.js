// jQuery Notifications v1.0
// A easy way to use notifications across browsers
// by Jonathan Fielding
(function(e){e.notifications=function(){var t={mobile_notifications:!0,notification_prompt_html:'<div class="ntfy_overlay"></div><div class="ntfy_request"><p>This website would like to display desktop notifications, your browser will now ask your permission</p> <a href="#">close</a></div>'},n=function(e,t){return window.webkitNotifications?e():t()},r=function(){if(!s()){e("body").append(t.notification_prompt_html);e(".ntfy_request a,.ntfy_overlay").click(function(){i();e(".ntfy_request, .ntfy_overlay").remove()})}},i=function(e){if(!s())e!==undefined?webkitNotifications.requestPermission(e):webkitNotifications.requestPermission(function(){});else{console.log("test");e()}},s=function(){var e=!1;webkitNotifications.checkPermission()===0&&(e=!0);return e},o=function(e,t,n){if(s()){var r=window.webkitNotifications.createNotification(e,t,n);return r}return!1},u=function(){if(!f()){e("body").append('<div class="ntfy_overlay"></div><div class="ntfy_request"><p>This website would like to display desktop notifications, your browser will now ask your permission</p> <a href="#">close</a></div>');e(".ntfy_request a,.ntfy_overlay").click(function(){a();e(".ntfy_request, .ntfy_overlay").remove()})}},a=function(t){e("body").append('<div class="ntfy_overlay"></div><div class="ntfy_request"><p>This website would like to display desktop notifications, cookies are used to manage these preferences</p> <a href="#" class="allow">allow</a><a href="#" class="deny">deny</a></div>');e(".ntfy_request").on("click","a",function(){var t=e(this);t.hasClass("allow")?c("permission","granted"):t.hasClass("deny")&&c("permission","denied");e(".ntfy_request, .ntfy_overlay").remove()})},f=function(){var e=!1;h("permission")==="granted"&&(e=!0);return e},l=function(t,n,r){if(t!==undefined&&n!==undefined&&r!==undefined)return f()?{show:function(){var t=e(".nfty_panel"),i=this,s="notify"+Math.floor(Math.random()*1e7),o=function(){e("#"+s).length&&e("#"+s).fadeOut("",function(){e(this).remove();i.onclose()})};if(t.length===0){e("body").append('<div class="nfty_panel"></div>');t=e(".nfty_panel")}t.append('<div class="ntfy_notification" style="display:none" id="'+s+'"><p class="ntfy_title">'+n+'</p><p class="ntfy_content">'+r+'</p><a href="#" class="close">close</a></div>');t.find(".ntfy_notification").last().fadeIn();setTimeout(o,4e3);e("#"+s).on("click",o);t.find(".ntfy_notification").on("click",this.onclick);i.onshow()},onclick:function(){},onclose:function(){alert("close")},ondisplay:function(){},onerror:function(){},onshow:function(){}}:!1;console.error("TypeError: Not enough arguments")},c=function(e,t){var n=new Date,r=365;n.setDate(n.getDate()+r);var i=escape(t)+(r==null?"":"; expires="+n.toUTCString());document.cookie=e+"="+t},h=function(e){var t,n,r,i=document.cookie.split(";");for(t=0;t<i.length;t++){n=i[t].substr(0,i[t].indexOf("="));r=i[t].substr(i[t].indexOf("=")+1);n=n.replace(/^\s+|\s+$/g,"");if(n==e)return unescape(r)}};return{config:function(e){},requestPermission:function(e){return n(function(){return i(e)},function(){return a(e)})},newNotification:function(e,t,r){return n(function(){return o(e,t,r)},function(){return l(e,t,r)})},checkPermission:function(){return n(function(){return s()},function(){return f()})},notificationPrompt:function(){return n(function(){return r()},function(){return u()})}}}()})(jQuery);